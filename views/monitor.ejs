<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <title>RingCentral High Volume SMS</title>
    <link href="./img/favicon.png" type="image/vnd.microsoft.icon" rel="shortcut icon">
    <link href="./img/favicon.png" type="image/vnd.microsoft.icon" rel="icon">
    <script src="js/common.js" type="text/javascript"></script>
    <script src="js/monitor.js" type="text/javascript"></script>


    <script src="js/jquery-3.1.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.3/css/bootstrap-select.min.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.3/js/bootstrap-select.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap3-dialog/1.34.7/js/bootstrap-dialog.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap3-dialog/1.34.7/css/bootstrap-dialog.min.css">
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <link rel="stylesheet" type="text/css" href="css/ui.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <link href="dist/css/tabulator.min.css" rel="stylesheet">
    <script type="text/javascript" src="dist/js/tabulator.min.js"></script>
    <!-- need this to support FireFox -->
    <!--
    <link  href="http://code.jquery.com/ui/1.10.0/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>
  	<script src="http://code.jquery.com/jquery-1.9.0.js"></script>
  	<script src="http://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    -->
    <script>
      window.activeUsers = <%- activeUsers %>
      //alert(usersActivities)
      window.usersActivities = <%- usersActivities %>
      window.allUsers = <%- allUsers %>
      $(document).ready(function(){
          $('[data-toggle="popover"]').popover();
      });

    </script>

</head>
<body onload="init()">
  <!--div id="hidden-div-user-info" class='modal-xl' style="display: none; width:1400px;">
    <form id="dialog" class='modal-dialog col-xs-12'>
      <div id="summary"></div>
      <div class="row col-xs-12">
        <div id="message-type" class="col-lg-6"></div>
        <div id="message-status" class="col-lg-6"></div>
      </div>
      <div class="row col-xs-12">
        <div id="campaign-type" class="col-lg-6"></div>
        <div id="page-access" class="col-lg-6"></div>
      </div>
      <div id="data"></div>
    </form>
  </div-->
  <!--div class="modal-xl" id="hidden-div-user-info" style="display: none;">
      <div class="modal-body">
        <form id="dialog" class='col-xs-12'>
          <div id="summary"></div>
          <div class="modal-content">
            <div class="row col-xs-12">
              <div id="message-type" class="col-lg-6"></div>
              <div id="message-status" class="col-lg-6"></div>
            </div>
            <div class="row col-xs-12">
              <div id="campaign-type" class="col-lg-6"></div>
              <div id="page-access" class="col-lg-6"></div>
            </div>
          </div>
          <div class="row col-xs-12">
            <h3 id="data">Last campaign data & time</h3>
            <div id="left" class="col-lg-6"></div>
            <div id="right" class="col-lg-6"></div>
          </div>

        </form>
     </div>
 </div-->
 <div class="modal-xl" id="hidden-div-user-info" style="display: none;">
       <form id="user_dialog" class='col-xs-12'>
         <div id="summary"></div>
           <div class="row col-xs-12">
             <div id="message-type" class="col-lg-6"></div>
             <div id="message-status" class="col-lg-6"></div>
           </div>
           <div class="row col-xs-12">
             <div id="campaign-type" class="col-lg-6"></div>
             <div id="page-access" class="col-lg-6"></div>
           </div>
         <div class="row col-xs-12">
           <h3 id="data">Last campaign data & time</h3>
           <div id="left" class="col-lg-6"></div>
           <div id="right" class="col-lg-6"></div>
         </div>
       </form>
  </div>
  <%- include('_feedback_form') %>
  <%- include('_menu_header') %>
  <section id='content'>
    <div class="row col-lg-12">
      <%- include('_menu') %>
      <div id="control-list-col" class="col-lg-2" style="width:310px">
        <div id="col2-header" class="form-inline read-message-input-block">
        <!--
          <label class="label-input" for="analytics-choices">Choices</label>
          <select id="analytics-choices" class="selectpicker filter-select" data-width="150" onchange="changeAnalyticsBase(this)">
            <option selected value="date-range">Date range</option>
            <option value="campaign-range">Campaigns</option>
          </select>
          <hr style="margin: 2px !important;border: 2px solid white"></hr>
        -->
          <div class="block_space">
            <label class="label-input" for="active-users">Active Users</label>
            <select id="active-users" class="selectpicker filter-select" onchange="displayActiveUserActivity()" data-width="120" title="active user">
              <% var users = JSON.parse(activeUsers) %>
              <% for (var item of users) { %>
              <option value="<%- item.id %>"><%= item.name %></option>
              <% } %>
            </select>
            <br>
            <div class="breakout" id="online-count"></div>
            <div class="breakout" id="campaigns-count"></div>
            <div class="breakout" id="conversations-count"></div>
            <div class="breakout" id="logs-count"></div>
            <div class="breakout" id="tf-sms-count"></div>
            <div class="breakout" id="settings-count"></div>
            <div class="breakout" id="analytics-count"></div>
            <div class="breakout" id="help-count"></div>
          </div>
        </div>
      </div>
      <div id="message-col" class="col-lg-9" style="background-color: #f5f6fb;">
        <div class="row col-lg-12">
          <label class="label-input" for="active-users">All Users</label>

            <% var users = JSON.parse(usersActivities) %>
            <% var totalDeliveredMessages = 0; var totalFailedMessages = 0 %>
            <% for (var user of users) { %>
              <% var activities = JSON.parse(user.activities) %>
              <% totalDeliveredMessages += activities.campaigns_logs.total_delivered %>
              <% totalFailedMessages += activities.campaigns_logs.total_failed %>
            <% } %>
          <label> Total delivered messages: <%- totalDeliveredMessages %></label>
          <label> Total failed messages: <%- totalFailedMessages %></label>
          <!--button class="btn-rc inline" onclick="readMessageStore()">Read</button-->
          <div class="col-lg-12">
            <div id="users-list" class="row col-lg-7"></div>
            <div class="col-lg-1"></div>
            <div id="message-snapshot-list" class="row col-lg-4" style="display: none"></div>

          </div>
        </div>
      </div>
    </div>
  </section>
  <%- include('_footer') %>
</body>
</html>
